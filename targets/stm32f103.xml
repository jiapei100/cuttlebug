<?xml version="1.0"?>
<document>
<peripheral name="advanced_timer">
	<reg name="CR1" fullname="Control Register 1" offset="0x0" as="short">
		<field name="CKD[1:0]" fullname="Clock Division" start="8" length="2" />
		<field name="ARPE" fullname="Auto-reload preload enable" start="7" length="1" />
		<field name="CMS[1:0]" fullname="Center-aligned mode selection" start="5" length="2" />
		<field name="DIR" fullname="Direction" start="4" length="1" />
		<field name="OPM" fullname="One pulse mode" start="3" length="1" />
		<field name="URS" fullname="Update request source" start="2" length="1" />
		<field name="UDIS" fullname="Update disable" start="1" length="1" />
		<field name="CEN" fullname="Counter enable" start="0" length="1" />
	</reg>
	<reg name="CR2" fullname="Control Register 2" offset="0x4" as="short" />
	<reg name="SMCR" fullname="Slave Mode Control Register" offset="0x8" as="short" />
	<reg name="DIER" fullname="DMA Interrupt Enable Register" offset="0xc" as="short" />
	<reg name="SR" fullname="Status Register" offset="0x10" as="short" />
	<reg name="EGR" fullname="Event Generation Register" offset="0x14" as="short" />
	<reg name="CCMR1" fullname="Capture/Compare Mode Register 1" offset="0x18" as="short" />
	<reg name="CCMR2" fullname="Capture/Compare Mode Register 2" offset="0x1c" as="short" />
	<reg name="CCER" fullname="Capture/Compare Enable Register" offset="0x20" as="short" />
	<reg name="CNT" fullname="Counter" offset="0x24" as="short" />
</peripheral>

<peripheral name="gpio">
    <reg name="CRL" fullname="Configuration Register (Low)" offset="0x0" as="int">
    	<field name="CNF7[1:0]" fullname="Port 7 Configuration Bits" start="30" length="2" />
    	<field name="MODE7[1:0]" fullname="Port 7 Mode Bits" start="28" length="2" />
    	<field name="CNF6[1:0]" fullname="Port 6 Configuration Bits" start="26" length="2" />
    	<field name="MODE6[1:0]" fullname="Port 6 Mode Bits" start="24" length="2" />
    	<field name="CNF5[1:0]" fullname="Port 5 Configuration Bits" start="22" length="2" />
    	<field name="MODE5[1:0]" fullname="Port 5 Mode Bits" start="20" length="2" />
    	<field name="CNF4[1:0]" fullname="Port 4 Configuration Bits" start="18" length="2" />
    	<field name="MODE4[1:0]" fullname="Port 4 Mode Bits" start="16" length="2" />
    	<field name="CNF3[1:0]" fullname="Port 3 Configuration Bits" start="14" length="2" />
    	<field name="MODE3[1:0]" fullname="Port 3 Mode Bits" start="12" length="2" />
    	<field name="CNF2[1:0]" fullname="Port 2 Configuration Bits" start="10" length="2" />
    	<field name="MODE2[1:0]" fullname="Port 2 Mode Bits" start="8" length="2" />
    	<field name="CNF1[1:0]" fullname="Port 1 Configuration Bits" start="6" length="2" />
    	<field name="MODE1[1:0]" fullname="Port 1 Mode Bits" start="4" length="2" />
    	<field name="CNF0[1:0]" fullname="Port 0 Configuration Bits" start="2" length="2" />
    	<field name="MODE0[1:0]" fullname="Port 0 Mode Bits" start="0" length="2" />
    </reg>
    
    <reg name="CRH" fullname="Configuration Register (Hi)" offset="0x4" as="int">
        <field name="CNF15[1:0]" fullname="Port 15 Configuration Bits" start="30" length="2" />
    	<field name="MODE15[1:0]" fullname="Port 15 Mode Bits" start="28" length="2" />
    	<field name="CNF14[1:0]" fullname="Port 14 Configuration Bits" start="26" length="2" />
    	<field name="MODE14[1:0]" fullname="Port 14 Mode Bits" start="24" length="2" />
    	<field name="CNF13[1:0]" fullname="Port 13 Configuration Bits" start="22" length="2" />
    	<field name="MODE13[1:0]" fullname="Port 13 Mode Bits" start="20" length="2" />
    	<field name="CNF12[1:0]" fullname="Port 12 Configuration Bits" start="18" length="2" />
    	<field name="MODE12[1:0]" fullname="Port 12 Mode Bits" start="16" length="2" />
    	<field name="CNF11[1:0]" fullname="Port 11 Configuration Bits" start="14" length="2" />
    	<field name="MODE11[1:0]" fullname="Port 11 Mode Bits" start="12" length="2" />
    	<field name="CNF10[1:0]" fullname="Port 10 Configuration Bits" start="10" length="2" />
    	<field name="MODE10[1:0]" fullname="Port 10 Mode Bits" start="8" length="2" />
    	<field name="CNF9[1:0]" fullname="Port 9 Configuration Bits" start="6" length="2" />
    	<field name="MODE9[1:0]" fullname="Port 9 Mode Bits" start="4" length="2" />
    	<field name="CNF8[1:0]" fullname="Port 8 Configuration Bits" start="2" length="2" />
    	<field name="MODE8[1:0]" fullname="Port 8 Mode Bits" start="0" length="2" />
    </reg>
    
    <reg name="IDR" fullname="Input Data Register" offset="0x8" as="short" >
    	<field name="IDR15" start="15" length="1" />
    	<field name="IDR14" start="14" length="1" />
    	<field name="IDR13" start="13" length="1" />
    	<field name="IDR12" start="12" length="1" />
    	<field name="IDR11" start="11" length="1" />
    	<field name="IDR10" start="10" length="1" />
    	<field name="IDR9" start="9" length="1" />
    	<field name="IDR8" start="8" length="1" />
    	<field name="IDR7" start="7" length="1" />
    	<field name="IDR6" start="6" length="1" />
    	<field name="IDR5" start="5" length="1" />
    	<field name="IDR4" start="4" length="1" />
    	<field name="IDR3" start="3" length="1" />
    	<field name="IDR2" start="2" length="1" />
    	<field name="IDR1" start="1" length="1" />
    	<field name="IDR0" start="0" length="1" />
	</reg>
	
    <reg name="ODR" fullname="Output Data Register" offset="0xc" as="short">
        <field name="ODR15" start="15" length="1" />
    	<field name="ODR14" start="14" length="1" />
    	<field name="ODR13" start="13" length="1" />
    	<field name="ODR12" start="12" length="1" />
    	<field name="ODR11" start="11" length="1" />
    	<field name="ODR10" start="10" length="1" />
    	<field name="ODR9" start="9" length="1" />
    	<field name="ODR8" start="8" length="1" />
    	<field name="ODR7" start="7" length="1" />
    	<field name="ODR6" start="6" length="1" />
    	<field name="ODR5" start="5" length="1" />
    	<field name="ODR4" start="4" length="1" />
    	<field name="ODR3" start="3" length="1" />
    	<field name="ODR2" start="2" length="1" />
    	<field name="ODR1" start="1" length="1" />
    	<field name="ODR0" start="0" length="1" />
    </reg>
    
    <reg name="BSRR" fullname="Port Bit Set/Reset Register" offset="0x10" as="int" />
    <reg name="BRR" fullname="Port Bit Reset Register" offset="0x14" as="short" />
    <reg name="LCKR" fullname="Port Config Lock Register" offset="0x18" as="int" />
</peripheral>

<peripheral name="rcc">
    <reg name="CR" fullname="Control Register" offset="0x00" as="int" />
    <reg name="CFGR" fullname="Configuration Register" offset="0x04" as="int" />
    <reg name="CIR" fullname="Interrupt Register" offset="0x08" as="int" />
    <reg name="APB2RSTR" fullname="APB2 Peripheral Reset Register" offset="0x0c" as="int" />
    <reg name="APB1RSTR" fullname="APB1 Peripheral Reset Register" offset="0x10" as="int" />
    <reg name="AHBENR" fullname="AHB Peripheral Clock Enable Register" offset="0x14" as="int" />
    <reg name="APB2ENR" fullname="APB2 Peripheral Clock Enable Register" offset="0x18" as="int" />
    <reg name="APB1ENR" fullname="APB1 Peripheral Clock Enable Register" offset="0x1C" as="int" />
    <reg name="BDCR" fullname="Backup Domain Control Register" offset="0x20" as="int" />
    <reg name="CSR" fullname="Control/Status Register" offset="0x24" as="int" />
    <reg name="AHBRSTR" fullname="AHB Peripheral Clock Reset Register" offset="0x28" as="int" />
    <reg name="CFGR2" fullname="Configuration Register 2" offset="0x2c" as="int" />

</peripheral>

<peripheral name="timer">
	<reg name="CR1" fullname="Control Register 1" offset="0x0" as="int" />
	<reg name="CR2" fullname="Control Register 2" offset="0x4" as="int" />
	<reg name="SMCR" fullname="Slave Mode Control Register" offset="0x8" as="int" />
	<reg name="DIER" fullname="DMA Interrupt Enable Register" offset="0xc" as="int" />
	<reg name="SR" fullname="Status Register" offset="0x10" as="int" />
	<reg name="EGR" fullname="Event Generation Register" offset="0x14" as="int" />
	<reg name="CCMR1" fullname="Capture/Compare Mode Register 1" offset="0x18" as="int" />
	<reg name="CCMR2" fullname="Capture/Compare Mode Register 2" offset="0x1c" as="int" />
	<reg name="CCER" fullname="Capture/Compare Enable Register" offset="0x20" as="int" />
	<reg name="CNT" fullname="Counter" offset="0x24" as="int" />
	<reg name="PSC" fullname="Prescaler" offset="0x28" as="int" />
	<reg name="ARR" fullname="Auto Reload Register" offset="0x2c" as="int" />
	<reg name="CCR1" fullname="Capture/Compare Register 1" offset="0x34" as="int" />
	<reg name="CCR2" fullname="Capture/Compare Register 2" offset="0x38" as="int" />
	<reg name="CCR3" fullname="Capture/Compare Register 3" offset="0x3c" as="int" />
	<reg name="CCR4" fullname="Capture/Compare Register 4" offset="0x40" as="int" />
	<reg name="DCR" fullname="DMA Control Register" offset="0x48" as="int" />
</peripheral>

<peripheral name="dac">
    <reg name="DAC_CR" fullname="DAC Control Register" offset="0x0" as="int" />
    <reg name="DAC_SWTRIGR" fullname="Software Trigger Register" offset="0x4" as="int" />
    
    <reg name="DAC_DHR12R1" fullname="Ch1 12-bit Right-Aligned Holding Register" offset="0x8" as="int" />
    <reg name="DAC_DHR12L1" fullname="Ch1 12-bit Left-Aligned Holding Register" offset="0xc" as="int" />
    <reg name="DAC_DHR8R1" fullname="Ch1 8-bit  Right-Aligned Holding Register" offset="0x10" as="int" />
    
    <reg name="DAC_DHR12R2" fullname="Ch2 12-bit Right-Aligned Holding Register" offset="0x14" as="int" />
    <reg name="DAC_DHR12L2" fullname="Ch2 12-bit Left-Aligned Holding Register" offset="0x18" as="int" />
    <reg name="DAC_DHR8R2" fullname="Ch2 8-bit  Right-Aligned Holding Register" offset="0x1c" as="int" />

    <reg name="DAC_DHR12RD" fullname="Dual 12-bit Right-Aligned Holding Register" offset="0x20" as="int" />
    <reg name="DAC_DHR12LD" fullname="Dual 12-bit Left-Aligned Holding Register" offset="0x24" as="int" />
    <reg name="DAC_DHR8RD" fullname="Dual 8-bit  Right-Aligned Holding Register" offset="0x28" as="int" />

    <reg name="DAC_DOR1" fullname="Ch1 Data Output Register" offset="0x2C" as="int" />
    <reg name="DAC_DOR2" fullname="Ch2 Data Output Register" offset="0x30" as="int" />
</peripheral>

<peripheral name="dma">
    <reg name="DMA_ISR" fullname="Interrupt Status Register" offset="0x0" as="int" />
    <reg name="DMA_IFCR" fullname="Interrupt Flag Clear Register" offset="0x4" as="int" />
</peripheral>

<peripheral name="usb">
	<reg name="CNTR" fullname="Control Register" offset="0x40" as="short" />
	<reg name="ISTR" fullname="Interrupt Status Register" offset="0x44" as="short" />
	<reg name="FNR" fullname="Frame Number Register" offset="0x48" as="short">
		<field name="RXDP" fullname="Receive Data + Line Status" start="15" length="1" />
		<field name="RXDM" fullname="Receive Data + Line Status" start="14" length="1" />
		<field name="LCK" fullname="Locked" start="13" length="1" />
		<field name="LSOF[1:0]" fullname="Lost SOF" start="11" length="2" />
		<field name="FN[10:0]" fullname="Frame Number" start="0" length="11" />
	</reg>
	<reg name="DADDR" fullname="Device Address " offset="0x4c" as="short" />
	<reg name="BTABLE" fullname="Buffer Table Address" offset="0x50" as="short" />
	<reg name="EP0R" fullname="Endpoint 0 Register" offset="0x00" as="short" />
	<reg name="EP1R" fullname="Endpoint 1 Register" offset="0x04" as="short" />
	<reg name="EP2R" fullname="Endpoint 2 Register" offset="0x08" as="short" />
	<reg name="EP3R" fullname="Endpoint 3 Register" offset="0x0c" as="short" />
	<reg name="EP4R" fullname="Endpoint 4 Register" offset="0x10" as="short" />
	<reg name="EP5R" fullname="Endpoint 5 Register" offset="0x14" as="short" />
	<reg name="EP6R" fullname="Endpoint 6 Register" offset="0x18" as="short" />
	<reg name="EP7R" fullname="Endpoint 7 Register" offset="0x1c" as="short" />	
</peripheral>

<peripheral name="exti">
    <reg name="IMR" fullname="Interrupt Mask Register" offset="0x00" as="int" />
    <reg name="EMR" fullname="Event Mask Register" offset="0x04" as="int" />
    <reg name="RTSR" fullname="Rising Trigger Selection Register" offset="0x08" as="int" />
    <reg name="FTSR" fullname="Falling Trigger Selection Register" offset="0x0c" as="int" />
    <reg name="SWIER" fullname="Software Interrupt Event Register" offset="0x10" as="int" />
    <reg name="PR" fullname="Pending Register" offset="0x14" as="int" />
</peripheral>

<target name="STM32F103">
    <invoke peripheral="rcc" name="RCC" fullname="RCC" base="0x40021000" />
	<group fullname="Timers">
		<invoke peripheral="timer" name="TIM2" fullname="Timer 2" base="0x40000000" />	
		<invoke peripheral="timer" name="TIM3" fullname="Timer 3" base="0x40000400" />	
		<invoke peripheral="timer" name="TIM4" fullname="Timer 4" base="0x40000800" />	
		<invoke peripheral="timer" name="TIM5" fullname="Timer 5" base="0x40000fff" />	
		<invoke peripheral="timer" name="TIM6" fullname="Timer 6" base="0x400013ff" />	
		<invoke peripheral="timer" name="TIM7" fullname="Timer 7" base="0x400017ff" />	
	</group>
	<group fullname="Advanced Timers">
		<invoke peripheral="advanced_timer" name="TIM1" fullname="Timer 1 (Advanced Timer)" base="0x40012c00" />
		<invoke peripheral="timer" name="TIM8" fullname="Timer 8 (Advanced Timer)" base="0x40013400" />	
	</group>
    <invoke peripheral="dac" name="DAC" fullname="DAC" base="0x40007400" />
    <group fullname="GPIO">
        <invoke peripheral="gpio" name="GPIOA" base="0x40010800" />
        <invoke peripheral="gpio" name="GPIOB" base="0x40010C00" />
        <invoke peripheral="gpio" name="GPIOC" base="0x40011000" />
        <invoke peripheral="gpio" name="GPIOD" base="0x40011400" />
        <invoke peripheral="gpio" name="GPIOE" base="0x40011800" />
        <invoke peripheral="gpio" name="GPIOF" base="0x40011C00" />
        <invoke peripheral="gpio" name="GPIOG" base="0x40012000" />
    </group>
    <invoke peripheral="usb" name="USB" fullname="USB" base="0x40005c00" />
    <invoke peripheral="exti" name="EXTI" fullname="External Interrupt/Event Controller" base="0x40010400" />
</target>
</document>
